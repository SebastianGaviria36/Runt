---
title: "Informe Técnico"
author: 
  - "Juan José Galeano Arenas"
  - "Simón Pedro Galeano Muñoz"
  - "Sebastian Gaviria Sanchez"
  - "Verónica Ríos Vargas"
output: 
  html_document:
    toc: true
    theme: united
    css: fontsize.css 
bibliography: citas.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, fig.align = "center")
library(knitr)
library(tidyverse)
library(magrittr)
library(lubridate)
library(forecast)
library(rjson)
library(plotly)
```

En este informe se muestra el proceso de creación de variables para la construcción del modelo así como hallazgos encontrados para el proceso de modelación.

# Construcción de la base de datos

La base de datos originalmente contaba con dos variables, fecha y unidades (la cual es la variable respuesta). Esta base estaba limpia pues no se encontraron incongruencias, valores faltantes, entre otros.

## Creación de variables

### Variables categóricas

Inicialmente se uso la fecha para crear las variables día, mes, año y semana. Para dicho propósito se usaron las funciones `wday()`, `month`, `year()`, y `week()` de la librería `lubridate`. Dichas funciones fueron aplicadas a la variable fecha, la cual fue transformada previamente en un objeto de la clase date con la función `as.Date()` del paquete `base` de R. Por último se considero la variable festivos la cual se construyó gracias a un repositorio de GitHub [@RepoNequi] donde se encontró un modulo node.js el cual a través de JavaScript se pudo exportar a un objeto JSON, luego se usó la función `fromJSON()` de la librería `rjson` para poder trabajar con JavaScript Objects Notation (JSON) en R y así extraer los datos de los días festivos en Colombia.

### Variables numéricas

En este caso se consideraron variables numéricas las cuales tienen que ver con el cambio económico del país a lo largo de los años puesto que el aumento o decremento de estas podría afectar el poder adquisitivo de los ciudadanos, dichas variables fueron: PIB anual, PIB persona [@PIB], tasa de cambio representativo del mercado del dolar (TRM) [@TRM], salario mínimo [@SalMinimo], índice de precios al consumidor (IPC) e inflación mensual [@IPC]. Todas estas variables fueron tomadas de internet de páginas gubernamentales y luego fueron agregadas a la base de datos gracias a diversas funciones de la librería `dplyr` como `inner_join()`, `mutate()`, `filter()`, `select()`, entre otras.

```{r objetos edaed, warning=FALSE}
#Invocando datos y plots del archivo Edaed.R
source("Edaed.r", encoding = "UTF-8")
kable(head(datos), longtable = T, align = "c",
      col.names = c("Fecha", "Unidades", "Día", "Mes", "Año", "Semana",
                    "Festivo", "PIB anual", "PIB persona", "TRM",
                    "Salario mínimo", "IPC", "Inflación mensual"))
```

# Análisis descriptivo

En esta sección se presentan diversos gráficos para detectar posibles
relaciones entre las covariables y la respuesta.

### Distribución del número global de vehículos registrados en los distintos días de la semana

```{r unidades-dia-semana-global, fig.cap="Unidades registradas en cada día de la semana (global)"}
p1
```
Se aprecia una clara diferencia entre el número de vehículos registrados en los diferentes días de la semana siendo sábado aquel día que, objetivamente, menos registros se presentan. La escasez de registros del domingo es debida a que "no se registran vehículos", sin embargo no debería tener registros; la frecuencia no nula de dicho día se podría deber a retrasos o incluso los típicos "privilegios" que ayudan a algunos usuarios a realizar el tramite días de trabajo inhábiles.

### Distribución del número de vehiculos registrados en los distintos días de la semana discriminando por año

El análisis previo se desarrollo de manera global, sin embargo, surge la duda de si dicho comportamiento cambia en los distintos años o se mantiene igual

```{r discrimina-ano, fig.cap="Unidades registradas en cada día de la semana (anual)"}
p2
```
Observe que el número de registros por día se distribuye de forma similar a lo largo de los años, también se aprecia que a medida que avanzan los años el número de registros es menor lo cual sugiere que existen fenómenos que han afectado el poder adquisitivo de las personas.

### Correlación lineal entre variables numéricas

La correlación lineal interesa por dos principales razones

* Observar si un modelo lineal es útil para predecir el número de vehículos registrados un día particular.
* Evitar potenciales problemas de multicolinealidad entre producido por covariables que estén muy correlacionadas.

```{r corr-matrix, fig.cap="Correlación lineal entre variables numéricas"}
p4
```
Note que la correlación lineal entre la variable respuesta y cada una de las covariables es muy baja por lo que un modelo lineal usando los regresores crudos puede no ser adecuado. Por otro lado, a excepción de la inflación mensual, los predictores están muy correlacionados linealmente y por lo tanto provocar potentes problemas de multicolinealidad, luego en caso de usar variables numéricas en modelos sensibles a la multicolinealidad se debería tomar únicamente una de estas.

### Diagramas de dispersión para Unidades vs regresores

Puesto que las correlaciones lineales son muy bajas, se grafican diagramas de dispersión con el propósito de hallar posibles relaciones de otro tipo entre el número de registros de vehículos diarios y las variables predictoras numéricas

```{r scatters, fig.cap="Diagramas de dispersión"}
ggpubr::ggarrange(s1, s2, s3, s4, s5, s6, ncol = 2, nrow = 3)
```
En ningún caso se logra detectar algún tipo de relación funcional entre las covariables y la respuesta lo cual sugiere que estas variables pueden no ser útiles para el proceso de modelación.

# Modelación

# Bibliografía



